language: php

services:
  - docker

php:
  - '7.2'

git:
  depth: 1

before_install:
  - composer install
  - vendor/unb-libraries/dockworker/scripts/travis/init.sh

script:
  - set -e
  - vendor/bin/dockworker local:build-test
  - vendor/unb-libraries/dockworker/scripts/kubectl/init.sh
  - vendor/bin/dockworker image:deploy $TRAVIS_BRANCH

notifications:
  slack:
    rooms:
      secure: aWfE4v0p3NoN4ms0CEBuu/Xv+igYL9mUs4/5iQWmkzVC7jzDPo4pu8PzCx24hS7c39pPZUZX085/yFbFYjWlzrflqmIB4LsOVZZe+SB5Zzg8dw3mSfprM7RF1iMEgoaWommAdmLOrUu/ZTkFZgaYW7E3sdPMRLHy330sIMnY9SDwMuYQXlrgUU7bZGI3+jVxpD6h9+TH+IuVXVM2XWFwn9wzu5uHksjCav6QNelKk/WBywCer/embmTfomI4NhJFqgF9Lpb87cXIgBUg57AFIY3iwu8dLX+UM/WNUMfdX5ZtpFhUWg03Tx/T3Bcjr3lqBLe+/wxshYVDqmlbZw+iWnxKNWzb569/gpYo/NzysJmj95nNnsJvsaoJVC7gA42V20lylob0n31sgUBJ8OHJHJ2X6e9wEVeWSAI6j2UnQzIS7SRHvQo+TwHBf6rXFq8k6O7gX54tb/ODFFofYFRB5fX4U+45Ny6yX1iHad+aoH+HBxs3zw0/3v3dFY5koxfOn61D9pqwdywhVxf5uxFb/A+09o+NmRaqSRv+cSb6qHrLFiLlNXChxSMXXgt2ffBVKaqqUKL77VGgkoMPCMwqSxVmN1QKQUKn/ou13TZmj0O1Bzl0AE6dHofLu1ZhFAK5MUPYpmEqO52k7b7ZyGW38eODstx23BDINI4Upnv4RPU=
    on_start: always
    on_success: always
